!function(){priorityNav.init({navDropdownLabel:"",mainNavWrapper:".main-nav",breakPoint:300});let e=document.querySelector("body"),t=document.querySelector(".main-nav"),n=(document.querySelector(".main-nav__list"),document.querySelectorAll(".secondary-nav__list")),i=document.querySelector(".secondary-nav__container"),l=document.querySelectorAll(".main-nav__item"),a=document.querySelector(".nav__dropdown-toggle"),o=document.querySelector(".nav__dropdown"),c=document.querySelector(".third-nav-container"),s=n[2];function r(e,t){e.forEach((function(e){e.classList.contains(t)&&e.classList.remove(t)}))}function d(e){e.forEach((function(e){e.classList.contains("hidden")||e.classList.add("hidden")}))}function u(e){e.classList.remove("hidden")}function v(e){r(s.querySelectorAll("li"),"active"),c.innerHTML="";let t=this.scrollLeft;e=window.event||e;let n=Math.max(-1,Math.min(1,e.wheelDelta||-e.detail));this.scrollLeft-=20*n;let i=this.scrollWidth,l=document.documentElement.clientWidth;1==n&&0==this.scrollLeft||l>=i||t==this.scrollLeft||e.preventDefault()}l.forEach((function(e,t){e.setAttribute("index",t)})),e.addEventListener("mousedown",(function(e){let t=e.target;(t.classList.contains("active")?t:t.parentNode.classList.contains("active")?t.parentNode:t.parentNode.parentNode.classList.contains("active")?t.parentNode.parentNode:null)||t.classList.contains("third-nav")||t.classList.contains("third-nav__level-1")||t.classList.contains("third-nav__level-2")||t.classList.contains("third-nav__inner-list")||t.classList.contains("third-nav__inner-link")||(r(s.querySelectorAll("li"),"active"),c.innerHTML="")})),window.addEventListener("resize",(function(e){r(s.querySelectorAll("li"),"active"),c.innerHTML=""})),i.addEventListener("touchstart",(function(e){let t=0;function n(e){r(s.querySelectorAll("li"),"active"),c.innerHTML="";let n=e.changedTouches[0];0!==t&&(i.scrollLeft+=t-n.clientX),t=n.clientX}document.addEventListener("touchmove",n),document.addEventListener("touchend",(function e(t){document.removeEventListener("touchmove",n),document.removeEventListener("touchend",e)}))})),i.addEventListener("mousedown",(function(e){let t=0,n=!1;function l(e){r(s.querySelectorAll("li"),"active"),c.innerHTML="",e.preventDefault(),n=!0,0!==t&&(i.scrollLeft+=t-e.clientX),t=e.clientX}document.addEventListener("mousemove",l),document.addEventListener("mouseup",(function e(t){let a,o=!1;if(!n){let e=t.target;a="li"===e.tagName.toLowerCase()?e:"li"===e.parentNode.tagName.toLowerCase()?e.parentNode:"li"===e.parentNode.parentNode.tagName.toLowerCase()?e.parentNode.parentNode:null}if(a&&a.classList.contains("active")&&(a.classList.remove("active"),c.innerHTML="",o=!0),a&&!a.classList.contains("active")&&!o){r(s.querySelectorAll("li"),"active"),a.classList.add("active");let e=a.querySelector(".third-nav"),t=a.querySelector(".third-nav__inner-list-wrap"),n=!!e&&e.cloneNode(!0),l=!!t&&t.cloneNode(!0),o=a.getBoundingClientRect(),d=i.getBoundingClientRect(),u=i.parentNode.getBoundingClientRect();o.right>d.right&&(i.scrollLeft+=o.right-d.right,o=a.getBoundingClientRect()),o.left<d.left&&(i.scrollLeft+=o.left-d.left,o=a.getBoundingClientRect()),n&&(n.querySelectorAll("li").forEach((function(e,t){e.setAttribute("index",t)})),c.appendChild(n),l&&c.appendChild(l),c.style.right="auto",c.style.top=o.height+"px",c.style.left=o.left-u.left==0?0:o.left-u.left+"px",c.getBoundingClientRect().right>document.body.clientWidth&&(c.style.left="auto",c.style.right=0))}document.removeEventListener("mousemove",l),document.removeEventListener("mouseup",e)}))})),i.addEventListener("mousewheel",v),i.addEventListener("DOMMouseScroll",v),c.addEventListener("click",(function(e){let t=e.target,n=c.querySelectorAll(".third-nav__inner-list"),i=c.querySelectorAll(".third-nav__level-1");t.classList.contains("third-nav__level-1")&&!t.classList.contains("third-nav__level-1--active")&&(n[0]&&(r(i,"third-nav__level-1--active"),d(n),t.classList.add("third-nav__level-1--active"),u(n[+t.getAttribute("index")])),c.getBoundingClientRect().right>document.body.clientWidth&&(c.style.left="auto",c.style.right=0))})),t.addEventListener("click",(function(e){let i=e.target,c=i.classList.contains("main-nav__item")?i:i.parentNode.classList.contains("main-nav__item")?i.parentNode:i.parentNode.parentNode.classList.contains("main-nav__item")?i.parentNode.parentNode:null;if(null!==c&&(c.parentNode===o&&(a.classList.remove("is-open"),t.classList.remove("is-open"),o.classList.remove("show"),o.setAttribute("aria-hidden",!0)),!c.classList.contains("main-nav__item--active"))){let e=+c.getAttribute("index"),t=n[e];r(l,"main-nav__item--active"),r(s.querySelectorAll("li"),"active"),c.classList.add("main-nav__item--active"),d(n),t&&(s=t,u(t))}}))}();
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1lbnUuanMiXSwibmFtZXMiOlsicHJpb3JpdHlOYXYiLCJpbml0IiwibmF2RHJvcGRvd25MYWJlbCIsIm1haW5OYXZXcmFwcGVyIiwiYnJlYWtQb2ludCIsImJvZHkiLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJtYWluTmF2Iiwic2Vjb25kYXJ5TmF2cyIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJzZWNvbmRhcnlOYXZCb3giLCJtYWluTmF2SXRlbXMiLCJtZW51QnV0dG9uIiwiZHJvcGRvd25OYXYiLCJ0aGlyZE5hdkNvbnRhaW5lciIsImN1cnJlbnRTZWNvbmRhcnlOYXYiLCJjbGVhckFjdGl2ZSIsIml0ZW1zIiwibmFtZSIsImZvckVhY2giLCJpdGVtIiwiY2xhc3NMaXN0IiwiY29udGFpbnMiLCJyZW1vdmUiLCJjbGVhclNob3duIiwiYWRkIiwic2hvd0l0ZW0iLCJzY3JvbGxIb3Jpem9udGFsbHkiLCJlIiwiaW5uZXJIVE1MIiwic2Nyb2xsUG9zIiwidGhpcyIsInNjcm9sbExlZnQiLCJ3aW5kb3ciLCJldmVudCIsImRlbHRhIiwiTWF0aCIsIm1heCIsIm1pbiIsIndoZWVsRGVsdGEiLCJkZXRhaWwiLCJ3aWR0aEVsZW0iLCJzY3JvbGxXaWR0aCIsIndpZHRoQnJvd3NlciIsImRvY3VtZW50RWxlbWVudCIsImNsaWVudFdpZHRoIiwicHJldmVudERlZmF1bHQiLCJpZHgiLCJzZXRBdHRyaWJ1dGUiLCJhZGRFdmVudExpc3RlbmVyIiwidGFyZ2V0IiwicGFyZW50Tm9kZSIsIngiLCJvblRvdWNoTW92ZSIsInRvdWNob2JqIiwiY2hhbmdlZFRvdWNoZXMiLCJjbGllbnRYIiwib25Ub3VjaEVuZCIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJtb3ZlZCIsIm9uTW91c2VNb3ZlIiwib25Nb3VzZVVwIiwiaXNBY3RpdmUiLCJ0YWdOYW1lIiwidG9Mb3dlckNhc2UiLCJ0aGlyZE5hdiIsInRoaXJkTmF2RGVlcCIsIm5vZGUiLCJjbG9uZU5vZGUiLCJub2RlRGVlcCIsIml0ZW1SZWN0IiwiZ2V0Qm91bmRpbmdDbGllbnRSZWN0IiwiYm94UmVjdCIsIndyYXBSZWN0IiwicmlnaHQiLCJsZWZ0IiwiYXBwZW5kQ2hpbGQiLCJzdHlsZSIsInRvcCIsImhlaWdodCIsImlubmVyTGlzdHMiLCJ0aGlyZE5hdkl0ZW1zIiwiZ2V0QXR0cmlidXRlIiwiZXZ0Iiwic2Vjb25kYXJ5TmF2Il0sIm1hcHBpbmdzIjoiQ0FBQSxXQUdBQSxZQUFBQyxLQUFBLENBQ0FDLGlCQUFBLEdBQ0FDLGVBQUEsWUFDQUMsV0FBQSxNQUxBLElBU0FDLEVBQUFDLFNBQUFDLGNBQUEsUUFDQUMsRUFBQUYsU0FBQUMsY0FBQSxhQUVBRSxHQURBSCxTQUFBQyxjQUFBLG1CQUNBRCxTQUFBSSxpQkFBQSx5QkFDQUMsRUFBQUwsU0FBQUMsY0FBQSw2QkFDQUssRUFBQU4sU0FBQUksaUJBQUEsbUJBQ0FHLEVBQUFQLFNBQUFDLGNBQUEseUJBQ0FPLEVBQUFSLFNBQUFDLGNBQUEsa0JBQ0FRLEVBQUFULFNBQUFDLGNBQUEsd0JBRUFTLEVBQUFQLEVBQUEsR0FFQSxTQUFBUSxFQUFBQyxFQUFBQyxHQUNBRCxFQUFBRSxTQUFBLFNBQUFDLEdBQ0FBLEVBQUFDLFVBQUFDLFNBQUFKLElBQ0FFLEVBQUFDLFVBQUFFLE9BQUFMLE1BS0EsU0FBQU0sRUFBQVAsR0FDQUEsRUFBQUUsU0FBQSxTQUFBQyxHQUNBQSxFQUFBQyxVQUFBQyxTQUFBLFdBQ0FGLEVBQUFDLFVBQUFJLElBQUEsYUFLQSxTQUFBQyxFQUFBTixHQUNBQSxFQUFBQyxVQUFBRSxPQUFBLFVBcUNBLFNBQUFJLEVBQUFDLEdBQ0FaLEVBQUFELEVBQUFOLGlCQUFBLE1BQUEsVUFDQUssRUFBQWUsVUFBQSxHQUVBLElBQUFDLEVBQUFDLEtBQUFDLFdBRUFKLEVBQUFLLE9BQUFDLE9BQUFOLEVBQ0EsSUFBQU8sRUFBQUMsS0FBQUMsS0FBQSxFQUFBRCxLQUFBRSxJQUFBLEVBQUFWLEVBQUFXLGFBQUFYLEVBQUFZLFNBRUFULEtBQUFDLFlBQUEsR0FB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QUdBcEUsRUFBQXlELHdCQUFBRyxNQUFBckUsU0FBQUQsS0FBQXlDLGNBQ0EvQixFQUFBK0QsTUFBQUYsS0FBQSxPQUNBN0QsRUFBQStELE1BQUFILE1BQUEsT0E0Q0FuRSxFQUFBMEMsaUJBQUEsU0F4T0EsU0FBQWtDLEdBQ0EsSUFBQWpDLEVBQUFpQyxFQUFBakMsT0FDQTlCLEVBQUE4QixFQUFBN0IsVUFBQUMsU0FBQSxrQkFBQTRCLEVBQ0FBLEVBQUFDLFdBQUE5QixVQUFBQyxTQUFBLGtCQUFBNEIsRUFBQUMsV0FDQUQsRUFBQUMsV0FBQUEsV0FBQTlCLFVBQUFDLFNBQUEsa0JBQUE0QixFQUFBQyxXQUFBQSxXQUNBLEtBRUEsR0FBQSxPQUFBL0IsSUFJQUEsRUFBQStCLGFBQUF0QyxJQUNBRCxFQUFBUyxVQUFBRSxPQUFBLFdBQ0FoQixFQUFBYyxVQUFBRSxPQUFBLFdBQ0FWLEVBQUFRLFVBQUFFLE9BQUEsUUFDQVYsRUFBQW1DLGFBQUEsZUFBQSxLQUdBNUIsRUFBQUMsVUFBQUMsU0FBQSwyQkFBQSxDQUNBLElBQUF5QixHQUFBM0IsRUFBQThELGFBQUEsU0FDQUUsRUFBQTVFLEVBQUF1QyxHQUVBL0IsRUFBQUwsRUFBQSwwQkFDQUssRUFBQUQsRUFBQU4saUJBQUEsTUFBQSxVQUNBVyxFQUFBQyxVQUFBSSxJQUFBLDBCQUVBRCxFQUFBaEIsR0FDQTRFLElBQ0FyRSxFQUFBcUUsRUFDQTFELEVBQUEwRCxRQXZFQSIsImZpbGUiOiJzY3JpcHQubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uICgpIHtcbiAgbGV0IGhpZGVkID0gMDtcblxuICBsZXQgbmF2ID0gcHJpb3JpdHlOYXYuaW5pdCh7XG4gICAgbmF2RHJvcGRvd25MYWJlbDogYGAsXG4gICAgbWFpbk5hdldyYXBwZXI6IGAubWFpbi1uYXZgLFxuICAgIGJyZWFrUG9pbnQ6IDMwMCxcbiAgfSk7XG5cblxuICBsZXQgYm9keSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYGJvZHlgKTtcbiAgbGV0IG1haW5OYXYgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGAubWFpbi1uYXZgKTtcbiAgbGV0IG1haW5OYXZMaXN0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihgLm1haW4tbmF2X19saXN0YCk7XG4gIGxldCBzZWNvbmRhcnlOYXZzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChgLnNlY29uZGFyeS1uYXZfX2xpc3RgKTtcbiAgbGV0IHNlY29uZGFyeU5hdkJveCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYC5zZWNvbmRhcnktbmF2X19jb250YWluZXJgKTtcbiAgbGV0IG1haW5OYXZJdGVtcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoYC5tYWluLW5hdl9faXRlbWApO1xuICBsZXQgbWVudUJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYC5uYXZfX2Ryb3Bkb3duLXRvZ2dsZWApO1xuICBsZXQgZHJvcGRvd25OYXYgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGAubmF2X19kcm9wZG93bmApO1xuICBsZXQgdGhpcmROYXZDb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGAudGhpcmQtbmF2LWNvbnRhaW5lcmApO1xuXG4gIGxldCBjdXJyZW50U2Vjb25kYXJ5TmF2ID0gc2Vjb25kYXJ5TmF2c1syXTtcblxuICBmdW5jdGlvbiBjbGVhckFjdGl2ZShpdGVtcywgbmFtZSkge1xuICAgIGl0ZW1zLmZvckVhY2goZnVuY3Rpb24gKGl0ZW0pIHtcbiAgICAgIGlmIChpdGVtLmNsYXNzTGlzdC5jb250YWlucyhuYW1lKSkge1xuICAgICAgICBpdGVtLmNsYXNzTGlzdC5yZW1vdmUobmFtZSk7XG4gICAgICB9XG4gICAgfSlcbiAgfVxuXG4gIGZ1bmN0aW9uIGNsZWFyU2hvd24oaXRlbXMpIHtcbiAgICBpdGVtcy5mb3JFYWNoKGZ1bmN0aW9uIChpdGVtKSB7XG4gICAgICBpZiAoIWl0ZW0uY2xhc3NMaXN0LmNvbnRhaW5zKGBoaWRkZW5gKSkge1xuICAgICAgICBpdGVtLmNsYXNzTGlzdC5hZGQoYGhpZGRlbmApO1xuICAgICAgfVxuICAgIH0pO1xuICB9XG5cbiAgZnVuY3Rpb24gc2hvd0l0ZW0oaXRlbSkge1xuICAgIGl0ZW0uY2xhc3NMaXN0LnJlbW92ZShgaGlkZGVuYCk7XG4gIH1cblxuICBmdW5jdGlvbiBvbk1haW5OYXZDbGljayhldnQpIHtcbiAgICBsZXQgdGFyZ2V0ID0gZXZ0LnRhcmdldDtcbiAgICBsZXQgaXRlbSA9IHRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoYG1haW4tbmF2X19pdGVtYCkgPyB0YXJnZXRcbiAgICAgIDogdGFyZ2V0LnBhcmVudE5vZGUuY2xhc3NMaXN0LmNvbnRhaW5zKGBtYWluLW5hdl9faXRlbWApID8gdGFyZ2V0LnBhcmVudE5vZGVcbiAgICAgIDogdGFyZ2V0LnBhcmVudE5vZGUucGFyZW50Tm9kZS5jbGFzc0xpc3QuY29udGFpbnMoYG1haW4tbmF2X19pdGVtYCkgPyB0YXJnZXQucGFyZW50Tm9kZS5wYXJlbnROb2RlXG4gICAgICA6IG51bGw7XG5cbiAgICBpZiAoaXRlbSA9PT0gbnVsbCkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGlmIChpdGVtLnBhcmVudE5vZGUgPT09IGRyb3Bkb3duTmF2KSB7XG4gICAgICBtZW51QnV0dG9uLmNsYXNzTGlzdC5yZW1vdmUoYGlzLW9wZW5gKTtcbiAgICAgIG1haW5OYXYuY2xhc3NMaXN0LnJlbW92ZShgaXMtb3BlbmApO1xuICAgICAgZHJvcGRvd25OYXYuY2xhc3NMaXN0LnJlbW92ZShgc2hvd2ApO1xuICAgICAgZHJvcGRvd25OYXYuc2V0QXR0cmlidXRlKGBhcmlhLWhpZGRlbmAsIHRydWUpO1xuICAgIH1cblxuICAgIGlmICghaXRlbS5jbGFzc0xpc3QuY29udGFpbnMoYG1haW4tbmF2X19pdGVtLS1hY3RpdmVgKSkge1xuICAgICAgbGV0IGlkeCA9ICtpdGVtLmdldEF0dHJpYnV0ZShgaW5kZXhgKTtcbiAgICAgIGxldCBzZWNvbmRhcnlOYXYgPSBzZWNvbmRhcnlOYXZzW2lkeF07XG5cbiAgICAgIGNsZWFyQWN0aXZlKG1haW5OYXZJdGVtcywgYG1haW4tbmF2X19pdGVtLS1hY3RpdmVgKTtcbiAgICAgIGNsZWFyQWN0aXZlKGN1cnJlbnRTZWNvbmRhcnlOYXYucXVlcnlTZWxlY3RvckFsbChgbGlgKSwgYGFjdGl2ZWApO1xuICAgICAgaXRlbS5jbGFzc0xpc3QuYWRkKGBtYWluLW5hdl9faXRlbS0tYWN0aXZlYCk7XG5cbiAgICAgIGNsZWFyU2hvd24oc2Vjb25kYXJ5TmF2cyk7XG4gICAgICBpZiAoc2Vjb25kYXJ5TmF2KSB7XG4gICAgICAgIGN1cnJlbnRTZWNvbmRhcnlOYXYgPSBzZWNvbmRhcnlOYXY7XG4gICAgICAgIHNob3dJdGVtKHNlY29uZGFyeU5hdik7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgZnVuY3Rpb24gc2Nyb2xsSG9yaXpvbnRhbGx5KGUpIHtcbiAgICBjbGVhckFjdGl2ZShjdXJyZW50U2Vjb25kYXJ5TmF2LnF1ZXJ5U2VsZWN0b3JBbGwoYGxpYCksIGBhY3RpdmVgKTtcbiAgICB0aGlyZE5hdkNvbnRhaW5lci5pbm5lckhUTUwgPSBgYDtcblxuICAgIGxldCBzY3JvbGxQb3MgPSB0aGlzLnNjcm9sbExlZnQ7XG5cbiAgICBlID0gd2luZG93LmV2ZW50IHx8IGU7XG4gICAgbGV0IGRlbHRhID0gTWF0aC5tYXgoLTEsIE1hdGgubWluKDEsIChlLndoZWVsRGVsdGEgfHwgLWUuZGV0YWlsKSkpO1xuXG4gICAgdGhpcy5zY3JvbGxMZWZ0IC09IChkZWx0YSoyMCk7XG5cbiAgICBsZXQgd2lkdGhFbGVtID0gdGhpcy5zY3JvbGxXaWR0aDtcbiAgICBsZXQgd2lkdGhCcm93c2VyID0gZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmNsaWVudFdpZHRoO1xuXG4gICAgaWYgKChkZWx0YSA9PSAxICkgJiYgKHRoaXMuc2Nyb2xsTGVmdCA9PSAwKSkgcmV0dXJuO1xuICAgIGlmICgod2lkdGhCcm93c2VyID49IHdpZHRoRWxlbSkgfHwgKHNjcm9sbFBvcyA9PSB0aGlzLnNjcm9sbExlZnQpKSByZXR1cm47XG5cbiAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gIH1cblxuICBmdW5jdGlvbiBvblRvdWNoU3RhcnQoZSkge1xuICAgIGxldCB4ID0gMDtcblxuICAgIGZ1bmN0aW9uIG9uVG91Y2hNb3ZlKGUpIHtcbiAgICAgIGNsZWFyQWN0aXZlKGN1cnJlbnRTZWNvbmRhcnlOYXYucXVlcnlTZWxlY3RvckFsbChgbGlgKSwgYGFjdGl2ZWApO1xuICAgICAgdGhpcmROYXZDb250YWluZXIuaW5uZXJIVE1MID0gYGA7XG5cbiAgICAgIGxldCB0b3VjaG9iaiA9IGUuY2hhbmdlZFRvdWNoZXNbMF07XG5cbiAgICAgIGlmICh4ICE9PSAwKSB7XG4gICAgICAgIHNlY29uZGFyeU5hdkJveC5zY3JvbGxMZWZ0ICs9IHggLSB0b3VjaG9iai5jbGllbnRYO1xuICAgICAgfVxuXG4gICAgICB4ID0gdG91Y2hvYmouY2xpZW50WDtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBvblRvdWNoRW5kKGUpIHtcbiAgICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoYHRvdWNobW92ZWAsIG9uVG91Y2hNb3ZlKTtcbiAgICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoYHRvdWNoZW5kYCwgb25Ub3VjaEVuZClcbiAgICB9XG5cbiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKGB0b3VjaG1vdmVgLCBvblRvdWNoTW92ZSk7XG4gICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihgdG91Y2hlbmRgLCBvblRvdWNoRW5kKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIG9uTW91c2VEb3duKGUpIHtcbiAgICBsZXQgeCA9IDA7XG4gICAgbGV0IG1vdmVkID0gZmFsc2U7XG5cbiAgICBmdW5jdGlvbiBvbk1vdXNlTW92ZShlKSB7XG4gICAgICBjbGVhckFjdGl2ZShjdXJyZW50U2Vjb25kYXJ5TmF2LnF1ZXJ5U2VsZWN0b3JBbGwoYGxpYCksIGBhY3RpdmVgKTtcbiAgICAgIHRoaXJkTmF2Q29udGFpbmVyLmlubmVySFRNTCA9IGBgO1xuXG4gICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICBtb3ZlZCA9IHRydWU7XG5cbiAgICAgIGlmICh4ICE9PSAwKSB7XG4gICAgICAgIHNlY29uZGFyeU5hdkJveC5zY3JvbGxMZWZ0ICs9IHggLSBlLmNsaWVudFg7XG4gICAgICB9XG5cbiAgICAgIHggPSBlLmNsaWVudFg7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gb25Nb3VzZVVwKGUpIHtcbiAgICAgIGxldCBpdGVtO1xuICAgICAgbGV0IGlzQWN0aXZlID0gZmFsc2U7XG5cbiAgICAgIGlmICghbW92ZWQpIHtcbiAgICAgICAgbGV0IHRhcmdldCA9IGUudGFyZ2V0O1xuICAgICAgICBpdGVtID0gdGFyZ2V0LnRhZ05hbWUudG9Mb3dlckNhc2UoKSA9PT0gYGxpYCA/IHRhcmdldFxuICAgICAgICAgIDogdGFyZ2V0LnBhcmVudE5vZGUudGFnTmFtZS50b0xvd2VyQ2FzZSgpID09PSBgbGlgID8gdGFyZ2V0LnBhcmVudE5vZGVcbiAgICAgICAgICA6IHRhcmdldC5wYXJlbnROb2RlLnBhcmVudE5vZGUudGFnTmFtZS50b0xvd2VyQ2FzZSgpID09PSBgbGlgID8gdGFyZ2V0LnBhcmVudE5vZGUucGFyZW50Tm9kZVxuICAgICAgICAgIDogbnVsbDtcbiAgICAgIH1cblxuICAgICAgaWYgKGl0ZW0gJiYgaXRlbS5jbGFzc0xpc3QuY29udGFpbnMoYGFjdGl2ZWApKSB7XG4gICAgICAgIGl0ZW0uY2xhc3NMaXN0LnJlbW92ZShgYWN0aXZlYCk7XG4gICAgICAgIHRoaXJkTmF2Q29udGFpbmVyLmlubmVySFRNTCA9IGBgO1xuICAgICAgICBpc0FjdGl2ZSA9IHRydWU7XG4gICAgICB9XG5cbiAgICAgIGlmIChpdGVtICYmICFpdGVtLmNsYXNzTGlzdC5jb250YWlucyhgYWN0aXZlYCkgJiYgIWlzQWN0aXZlKSB7XG4gICAgICAgIGNsZWFyQWN0aXZlKGN1cnJlbnRTZWNvbmRhcnlOYXYucXVlcnlTZWxlY3RvckFsbChgbGlgKSwgYGFjdGl2ZWApO1xuICAgICAgICBpdGVtLmNsYXNzTGlzdC5hZGQoYGFjdGl2ZWApO1xuXG4gICAgICAgIGxldCB0aGlyZE5hdiA9IGl0ZW0ucXVlcnlTZWxlY3RvcihgLnRoaXJkLW5hdmApO1xuICAgICAgICBsZXQgdGhpcmROYXZEZWVwID0gaXRlbS5xdWVyeVNlbGVjdG9yKGAudGhpcmQtbmF2X19pbm5lci1saXN0LXdyYXBgKTtcblxuICAgICAgICBsZXQgbm9kZSA9ICEhdGhpcmROYXYgJiYgdGhpcmROYXYuY2xvbmVOb2RlKHRydWUpO1xuICAgICAgICBsZXQgbm9kZURlZXAgPSAhIXRoaXJkTmF2RGVlcCAmJiB0aGlyZE5hdkRlZXAuY2xvbmVOb2RlKHRydWUpO1xuXG4gICAgICAgIGxldCBpdGVtUmVjdCA9IGl0ZW0uZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XG4gICAgICAgIGxldCBib3hSZWN0ID0gc2Vjb25kYXJ5TmF2Qm94LmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xuICAgICAgICBsZXQgd3JhcFJlY3QgPSBzZWNvbmRhcnlOYXZCb3gucGFyZW50Tm9kZS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcblxuICAgICAgICBpZiAoaXRlbVJlY3QucmlnaHQgPiBib3hSZWN0LnJpZ2h0KSB7XG4gICAgICAgICAgc2Vjb25kYXJ5TmF2Qm94LnNjcm9sbExlZnQgKz0gaXRlbVJlY3QucmlnaHQgLSBib3hSZWN0LnJpZ2h0O1xuICAgICAgICAgIGl0ZW1SZWN0ID0gaXRlbS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChpdGVtUmVjdC5sZWZ0IDwgYm94UmVjdC5sZWZ0KSB7XG4gICAgICAgICAgc2Vjb25kYXJ5TmF2Qm94LnNjcm9sbExlZnQgKz0gaXRlbVJlY3QubGVmdCAtIGJveFJlY3QubGVmdDtcbiAgICAgICAgICBpdGVtUmVjdCA9IGl0ZW0uZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAobm9kZSkge1xuICAgICAgICAgIG5vZGUucXVlcnlTZWxlY3RvckFsbChgbGlgKS5mb3JFYWNoKGZ1bmN0aW9uIChpdGVtLCBpZHgpIHtcbiAgICAgICAgICAgIGl0ZW0uc2V0QXR0cmlidXRlKGBpbmRleGAsIGlkeCk7XG4gICAgICAgICAgfSk7XG5cbiAgICAgICAgICB0aGlyZE5hdkNvbnRhaW5lci5hcHBlbmRDaGlsZChub2RlKTtcbiAgICAgICAgICBpZiAobm9kZURlZXApIHtcbiAgICAgICAgICAgIHRoaXJkTmF2Q29udGFpbmVyLmFwcGVuZENoaWxkKG5vZGVEZWVwKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgdGhpcmROYXZDb250YWluZXIuc3R5bGUucmlnaHQgPSBgYXV0b2A7XG4gICAgICAgICAgdGhpcmROYXZDb250YWluZXIuc3R5bGUudG9wID0gaXRlbVJlY3QuaGVpZ2h0ICsgYHB4YDtcbiAgICAgICAgICB0aGlyZE5hdkNvbnRhaW5lci5zdHlsZS5sZWZ0ID0gKGl0ZW1SZWN0LmxlZnQgLSB3cmFwUmVjdC5sZWZ0KSA9PT0gMFxuICAgICAgICAgICAgPyAwXG4gICAgICAgICAgICA6IChpdGVtUmVjdC5sZWZ0IC0gd3JhcFJlY3QubGVmdCkgKyBgcHhgO1xuXG4gICAgICAgICAgaWYgKHRoaXJkTmF2Q29udGFpbmVyLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLnJpZ2h0ID4gZG9jdW1lbnQuYm9keS5jbGllbnRXaWR0aCkge1xuXG4gICAgICAgICAgICB0aGlyZE5hdkNvbnRhaW5lci5zdHlsZS5sZWZ0ID0gYGF1dG9gO1xuICAgICAgICAgICAgdGhpcmROYXZDb250YWluZXIuc3R5bGUucmlnaHQgPSAwO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKGBtb3VzZW1vdmVgLCBvbk1vdXNlTW92ZSk7XG4gICAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKGBtb3VzZXVwYCwgb25Nb3VzZVVwKTtcbiAgICB9XG5cbiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKGBtb3VzZW1vdmVgLCBvbk1vdXNlTW92ZSk7XG4gICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihgbW91c2V1cGAsIG9uTW91c2VVcCk7XG4gIH1cblxuICBmdW5jdGlvbiBvblRoaXJkTmF2Q2xpY2soZSkge1xuICAgIGxldCB0YXJnZXQgPSBlLnRhcmdldDtcbiAgICBsZXQgaW5uZXJMaXN0cyA9IHRoaXJkTmF2Q29udGFpbmVyLnF1ZXJ5U2VsZWN0b3JBbGwoYC50aGlyZC1uYXZfX2lubmVyLWxpc3RgKTtcbiAgICBsZXQgdGhpcmROYXZJdGVtcyA9IHRoaXJkTmF2Q29udGFpbmVyLnF1ZXJ5U2VsZWN0b3JBbGwoYC50aGlyZC1uYXZfX2xldmVsLTFgKTtcblxuICAgIGlmIChcbiAgICAgIHRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoYHRoaXJkLW5hdl9fbGV2ZWwtMWApXG4gICAgICAmJiAhdGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucyhgdGhpcmQtbmF2X19sZXZlbC0xLS1hY3RpdmVgKVxuICAgICkge1xuICAgICAgaWYgKGlubmVyTGlzdHNbMF0pIHtcbiAgICAgICAgY2xlYXJBY3RpdmUodGhpcmROYXZJdGVtcywgYHRoaXJkLW5hdl9fbGV2ZWwtMS0tYWN0aXZlYCk7XG4gICAgICAgIGNsZWFyU2hvd24oaW5uZXJMaXN0cyk7XG4gICAgICAgIHRhcmdldC5jbGFzc0xpc3QuYWRkKGB0aGlyZC1uYXZfX2xldmVsLTEtLWFjdGl2ZWApO1xuICAgICAgICBzaG93SXRlbShpbm5lckxpc3RzWyt0YXJnZXQuZ2V0QXR0cmlidXRlKGBpbmRleGApXSk7XG4gICAgICB9XG5cbiAgICAgIGlmICh0aGlyZE5hdkNvbnRhaW5lci5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS5yaWdodCA+IGRvY3VtZW50LmJvZHkuY2xpZW50V2lkdGgpIHtcbiAgICAgICAgdGhpcmROYXZDb250YWluZXIuc3R5bGUubGVmdCA9IGBhdXRvYDtcbiAgICAgICAgdGhpcmROYXZDb250YWluZXIuc3R5bGUucmlnaHQgPSAwO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIGZ1bmN0aW9uIG9uQW55Q2xpY2soZSkge1xuICAgIGxldCB0YXJnZXQgPSBlLnRhcmdldDtcbiAgICBsZXQgaXRlbSA9IHRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoYGFjdGl2ZWApID8gdGFyZ2V0XG4gICAgICA6IHRhcmdldC5wYXJlbnROb2RlLmNsYXNzTGlzdC5jb250YWlucyhgYWN0aXZlYCkgPyB0YXJnZXQucGFyZW50Tm9kZVxuICAgICAgOiB0YXJnZXQucGFyZW50Tm9kZS5wYXJlbnROb2RlLmNsYXNzTGlzdC5jb250YWlucyhgYWN0aXZlYCkgPyB0YXJnZXQucGFyZW50Tm9kZS5wYXJlbnROb2RlXG4gICAgICA6IG51bGw7XG5cbiAgICBpZiAoIWl0ZW1cbiAgICAgICYmICF0YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKGB0aGlyZC1uYXZgKVxuICAgICAgJiYgIXRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoYHRoaXJkLW5hdl9fbGV2ZWwtMWApXG4gICAgICAmJiAhdGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucyhgdGhpcmQtbmF2X19sZXZlbC0yYClcbiAgICAgICYmICF0YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKGB0aGlyZC1uYXZfX2lubmVyLWxpc3RgKVxuICAgICAgJiYgIXRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoYHRoaXJkLW5hdl9faW5uZXItbGlua2ApXG4gICAgKSB7XG4gICAgICBjbGVhckFjdGl2ZShjdXJyZW50U2Vjb25kYXJ5TmF2LnF1ZXJ5U2VsZWN0b3JBbGwoYGxpYCksIGBhY3RpdmVgKTtcbiAgICAgIHRoaXJkTmF2Q29udGFpbmVyLmlubmVySFRNTCA9IGBgO1xuICAgIH1cbiAgfVxuXG4gIGZ1bmN0aW9uIG9uUmVzaXplKGUpIHtcbiAgICBjbGVhckFjdGl2ZShjdXJyZW50U2Vjb25kYXJ5TmF2LnF1ZXJ5U2VsZWN0b3JBbGwoYGxpYCksIGBhY3RpdmVgKTtcbiAgICB0aGlyZE5hdkNvbnRhaW5lci5pbm5lckhUTUwgPSBgYDtcbiAgfVxuXG4gIG1haW5OYXZJdGVtcy5mb3JFYWNoKGZ1bmN0aW9uIChpdGVtLCBpZHgpIHtcbiAgICBpdGVtLnNldEF0dHJpYnV0ZShgaW5kZXhgLCBpZHgpO1xuICB9KTtcblxuICBib2R5LmFkZEV2ZW50TGlzdGVuZXIoYG1vdXNlZG93bmAsIG9uQW55Q2xpY2spO1xuICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcihgcmVzaXplYCwgb25SZXNpemUpO1xuXG4gIHNlY29uZGFyeU5hdkJveC5hZGRFdmVudExpc3RlbmVyKGB0b3VjaHN0YXJ0YCwgb25Ub3VjaFN0YXJ0KTtcbiAgc2Vjb25kYXJ5TmF2Qm94LmFkZEV2ZW50TGlzdGVuZXIoYG1vdXNlZG93bmAsIG9uTW91c2VEb3duKTtcblxuICBzZWNvbmRhcnlOYXZCb3guYWRkRXZlbnRMaXN0ZW5lcihgbW91c2V3aGVlbGAsIHNjcm9sbEhvcml6b250YWxseSk7XG4gIHNlY29uZGFyeU5hdkJveC5hZGRFdmVudExpc3RlbmVyKGBET01Nb3VzZVNjcm9sbGAsIHNjcm9sbEhvcml6b250YWxseSk7XG5cbiAgdGhpcmROYXZDb250YWluZXIuYWRkRXZlbnRMaXN0ZW5lcihgY2xpY2tgLCBvblRoaXJkTmF2Q2xpY2spO1xuXG4gIG1haW5OYXYuYWRkRXZlbnRMaXN0ZW5lcihgY2xpY2tgLCBvbk1haW5OYXZDbGljayk7XG59KSgpO1xuIl19
